import{H as g}from"./index-26603ea5.js";const u=g.global.t;class d{constructor(){}static getUserAvatar({puid:t}){return`headerimg://https://photo.chaoxing.com/p/${t}_80?flag=1&psize=100_100c&ext=jpg&_timeFlag=${new Date().getTime()}`}static getLocalUserAvatar({puid:t,timeStamp:r}){return`cximg://https://photo.chaoxing.com/p/${t}_80?flag=1&psize=100_100c&ext=jpg`+(r?`&_timeFlag=${r}`:"")}static uint8ArrayToFile(t,r,e){return new File([t],r,{type:e})}static createCid(){for(var t=[],r="0123456789abcdef",e=0;e<36;e++)t[e]=r.substr(Math.floor(Math.random()*16),1);t[14]="4",t[19]=r.substr(t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-";var n=t.join("");return n}static b64EncodeUnicode(t){var r=new RegExp(`(\\baler(?=t\\s*\\())|(\\bhref(?=\\s*=\\s*['"]?\\s*javascript:))|(\\bsrc(?=\\s*=\\s*['"]?\\s*javascript:))|((data|src)\\s*=['"]?\\s*data(?=:)(?!:\\s*image))|(^[^<]*<(?=/textarea\\s*>))|(<(?=(script)|(/script)))|(<(?=(details)|(/details)))|(\\b(onstart|onafterprint|onbeforeprint|onbeforeunload|onerror|onhaschange|onload|onmessage|onoffline|ononline|onpagehide|onpageshow|onpopstate|onredo|onresize|onstorage|onundo|onunload|onblur|onchange|oncontextmenu|onfocus|onformchange|onforminput|oninput|oninvalid|onreset|onreset|onsubmit|onkey\\w*|onclick|ondblclick|ondrag\\w*|ondrop|onmouse\\w*|onscroll|ontouch\\w*)(?=(\\s*)=))`,"gi");return t=t.replace(r,function(){return arguments[0]+"　"}),btoa(encodeURIComponent(t))}static b64DecodeUnicode(t){try{t=decodeURIComponent(atob(t))}catch{console.log(t)}return t}static typeJudgment(t){var e;return(e=Object.prototype.toString.call(t).match(/\s(\S*)\]/))==null?void 0:e[1]}static createFormData(t={}){if(this.typeJudgment(t)!=="Object")return t;const r=Object.keys(t),e=new FormData;for(let n=0;n<r.length;n++){const o=r[n];e.append(o,t[o])}return e}static convertImgToBase64(t,r){return new Promise((e,n)=>{let o=document.createElement("CANVAS"),s=o.getContext("2d"),a=new Image;a.crossOrigin="Anonymous",a.onload=()=>{o.height=a.height,o.width=a.width,s.drawImage(a,0,0);let l=o.toDataURL(r||"image/png");e(l),o=null},a.onerror=()=>{n(t)},a.src=t})}static base64toBlob(t){var a;for(var r=t.split(","),e=(a=r[0].match(/:(.*?);/))==null?void 0:a[1],n=atob(r[1]),o=n.length,s=new Uint8Array(o);o--;)s[o]=n.charCodeAt(o);return new Blob([s],{type:e})}static ImgToBase64(t,r){return new Promise((e,n)=>{let o=document.createElement("CANVAS"),s=o.getContext("2d"),a=new Image;a.crossOrigin="Anonymous",a.onload=function(){o.height=a.height,o.width=a.width,s.drawImage(a,0,0);let l=o.toDataURL(r||"image/png");o=null,e(l)},a.onerror=function(){n("ImgToBase64错误")},a.src=t})}static blobToBase64(t){return new Promise((r,e)=>{const n=new FileReader;n.onloadend=()=>{if(n.readyState===FileReader.DONE){const o=n.result;r(o)}else e(new Error("Failed to convert Blob to Base64."))},n.onerror=()=>{e(new Error("Error occurred while reading Blob."))},n.readAsDataURL(t)})}static httpImgToBase64(t){return new Promise((r,e)=>{const n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(){if(this.status===200){const o=new Uint8Array(this.response);let s="";for(let l=0;l<o.byteLength;l++)s+=String.fromCharCode(o[l]);const a=`data:image/png;base64,${btoa(s)}`;r(a)}},n.send()})}static async blobUrlToBase64(t){const e=await(await fetch(t)).blob();return new Promise((n,o)=>{const s=new FileReader;s.onload=()=>{const a=s.result.split(",")[1];n(a)},s.onerror=a=>o(a),s.readAsDataURL(e)})}static timeago(t,r=!1){let n=Date.now()-t;if(n<=6e4)return u("message.justnow");if(n>6e4&&n<36e5){let o=Math.floor(n/6e4);return o+(o>1?u("message.minsAgo"):u("message.minAgo"))}else if(Math.floor(n/36e5)<24){let o=Math.floor(n/36e5);return o+(o>1?u("message.hrsAgo"):u("message.hrAgo"))}else return this.parseDateFull(t,r)}static parseDateFull(t,r=!1){let e=new Date(t),n=e.getMonth()+1;n=n<10?"0"+n:n;let o=e.getDate();o=o<10?"0"+o:o;let s=n+"-"+o;new Date().getFullYear()!==e.getFullYear()&&(s=e.getFullYear()+"-"+s);let a=e.getHours();a=a<10?"0"+a:a;let l=e.getMinutes();l=l<10?"0"+l:l;let c=a+":"+l;return r?s+" "+c:s}static isDom(t){return typeof HTMLElement=="object"?t instanceof HTMLElement:!!(t&&typeof t=="object"&&(t.nodeType===1||t.nodeType===9)&&typeof t.nodeName=="string")}static urlCode(t,r=!0){return r?encodeURIComponent(t):decodeURIComponent(t)}static formatSize(t,r,e){var n;e=e||["B","KB","MB","GB","TB"];for(var o=0;o<e.length;o++)if(String(t).indexOf(e[o])!=-1)return t;for(;(n=e.shift())&&t>1024;)t=t/1024;return(n==="B"?t:t.toFixed(r===void 0?2:r))+n}static isHyperLink(t){var r="((http[s]{0,1}|ftp)://)?(((?:(?:25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))\\.){3}(?:25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))(:\\d+)?)|(([a-zA-Z0-9\\-]+\\.)+((hk)|(tw)|(cn\\.com)|(com\\.cn)|(com)|(top)|(cn)|(wang)|(net)|(org)|(co)|(cc)|(me)|(pw)|(la)|(asia)|(biz)|(mobi)|(name)|(info)|(tm)|(tv)|(tel)|(us)|(website)|(host)|(press)|(ren)|(im)|(ai)|(vip)))(:\\d+)?)(/[a-zA-Z0-9\\.\\-~!@#$%^&#$%^&amp;*+?:_/=&lt;&gt;()]*)?",e=new RegExp(r);return e.test(t)}static hyperLink(t,r=!0){if(r){var e="((http[s]{0,1}|ftp)://)?(((?:(?:25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))\\.){3}(?:25[0-5]|2[0-4]\\d|((1\\d{2})|([1-9]?\\d)))(:\\d+)?)|(([a-zA-Z0-9\\-]+\\.)+((hk)|(tw)|(cn\\.com)|(com\\.cn)|(com)|(top)|(cn)|(wang)|(net)|(org)|(co)|(cc)|(me)|(pw)|(la)|(asia)|(biz)|(mobi)|(name)|(info)|(tm)|(tv)|(tel)|(us)|(website)|(host)|(press)|(ren)|(im)|(ai)|(vip)))(:\\d+)?)(/[a-zA-Z0-9\\.\\-~!@#$%^&#$%^&amp;*+?:_/=&lt;&gt;()]*)?",n=new RegExp(e,"g"),o="";return t.indexOf("http")===-1&&(o="https://"),t.replaceAll(n,function(a){let l=a.trim(),c=!1;return l.endsWith("@")&&(l=l.slice(0,-1),c=!0),'<a class="hyper-link" href="'+o+l+'" target="_blank">'+l+"</a>"+(c?"@":"")})}else{var e=/<a\s+(?:[^>]*?\s+)?href=(["'])(.*?)\1[^>]*?>(.*?)<\/a>/g;return t.replaceAll(e,"$2")}}static htmlEncodeByRegExp(t){var r="";return!t||(t==null?void 0:t.length)==0?"":(r=t.replace(/&/g,"&amp;"),r=r.replace(/</g,"&lt;"),r=r.replace(/>/g,"&gt;"),r=r.replace(/\'/g,"&#39;"),r=r.replace(/\"/g,"&quot;"),r)}static htmlDecodeByRegExp(t){var r="";return!t||(t==null?void 0:t.length)==0?"":(r=t.replace(/&amp;/g,"&"),r=r.replace(/&lt;/g,"<"),r=r.replace(/&gt;/g,">"),r=r.replace(/&nbsp;/g," "),r=r.replace(/&#39;/g,"'"),r=r.replace(/&quot;/g,'"'),r)}static getDaysSince(t){var r=new Date;r.setHours(0,0,0,0);var e=r.getTime(),n=Math.abs(e-t),o=Math.ceil(n/(1e3*60*60*24));return o}static getMinutesSince(t){var r=new Date().getTime(),e=Math.abs(r-t),n=Math.ceil(e/(1e3*60));return n}static windowClickOnce(t,r){var e=this,n=function(){t.call(e,r),window.removeEventListener("click",n)};const o=setTimeout(()=>{window.addEventListener("click",n),clearTimeout(o)})}static getImgInfo(t){return new Promise((r,e)=>{const n=new Image;n.crossOrigin="Anonymous",n.onload=()=>{r({width:n.width,height:n.height})},n.onerror=()=>{e()},n.src=t})}static getVideoInfo(t){return new Promise((r,e)=>{let n=document.createElement("video");n.src=t;let o=setTimeout(function(){r({videoHeight:0,videoWidth:0,duration:0,cover:null})},500),s=function(){clearTimeout(o),r({videoHeight:n.videoHeight,videoWidth:n.videoWidth,duration:Math.floor(n.duration)}),n.removeEventListener("canplaythrough",s)};n.addEventListener("canplaythrough",s)})}static async downloadfile(t){const r=document.createElement("a");if(t.startsWith("cximg://")||t.startsWith("headerimg://"))r.href=t;else{const e=await fetch(t).then(n=>n.blob());r.href=window.URL.createObjectURL(e)}r.click()}static async downloadAttfile(t){const r=document.createElement("a");r.download=!0,r.href=t,r.click()}static formatDate(t){let r=new Date(t),e=r.getFullYear(),n=r.getMonth()+1,o=r.getDate(),s=r.getHours(),a=r.getMinutes();return r.getSeconds(),n<10&&(n="0"+n),o<10&&(o="0"+o),s<10&&(s="0"+s),a<10&&(a="0"+a),e+"-"+n+"-"+o+" "+s+":"+a}static formatTime(t){const r=Math.floor(t/1e3),e=Math.floor(r/3600),n=Math.floor((r-e*3600)/60),o=r-e*3600-n*60,s=e.toString().padStart(2,"0"),a=n.toString().padStart(2,"0"),l=o.toString().padStart(2,"0");return`${s}:${a}:${l}`}static matchType(t){let r="",e="";try{let i=t.split(".");r=i[i.length-1]}catch{r=""}return r?(e=["png","jpg","jpeg","bmp","gif"].some(function(i){return i==r}),e?(e="none",e):(e=["txt"].some(function(i){return i==r}),e?(e="txt",e):(e=["xls","xlsx"].some(function(i){return i==r}),e?(e="excel",e):(e=["doc","docx"].some(function(i){return i==r}),e?(e="word",e):(e=["pdf"].some(function(i){return i==r}),e?(e="pdf",e):(e=["pptx","ppt","pps","ppsx"].some(function(i){return i==r}),e?(e="ppt",e):(e=["mp4","m2v","mkv"].some(function(i){return i==r}),e?(e="video",e):(e=["mp3","wav","wmv"].some(function(i){return i==r}),e?(e="audio",e):(e=["zip","rar","tar","7z"].some(function(i){return i==r}),e?(e="rar",e):(e=["ti"].some(function(i){return i==r}),e?(e="ti",e):(e=["pdz"].some(function(i){return i==r}),e?(e="pdz",e):(e=["link"].some(function(i){return i==r}),e?(e="link",e):(e=["flash"].some(function(i){return i==r}),e?(e="flash",e):(e=["exe"].some(function(i){return i==r}),e?(e="exe",e):(e=["epub"].some(function(i){return i==r}),e?(e="epub",e):(e=["b"].some(function(i){return i==r}),e?(e="b",e):(e="other",e))))))))))))))))):(e=!1,e)}static byteConvert(t){if(isNaN(t)||t<0)return"0B";var r=["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],e=Math.floor(Math.log(t)/Math.log(2));e<1&&(e=0);var n=Math.floor(e/10);return t=t/Math.pow(2,10*n),t.toString().length>t.toFixed(2).toString().length&&(t=t.toFixed(2)),t?t+" "+r[n]:"0B"}static formatVersion(t){var r=t.split(".");r.length==3&&r[r.length-1]==="0"&&r.pop();var e=r.join(".");return e}static checkVersion(t,r){let e=Number(t.split(".").join("")),n=Number(r.split(".").join(""));return e>n}static getLocalVersion(){const t=navigator.userAgent,r=/\/ChaoXingStudy_\d+_(\d+(?:[\.-]\d+)+)/,e=t.match(r);if(console.log("match",e),e&&e[1]){let n=e[1];return n=n.replace("-","."),console.log(n),n}else return console.log("未找到匹配的版本号"),""}static removeSpaces(t){for(let r in t)if(typeof t[r]=="object"&&t[r]!==null&&this.removeSpaces(t[r]),typeof r=="string"){const e=r.replace(/\s+/g,"");r!==e&&(t[e]=t[r],delete t[r])}return t}static isJSONString(t){try{JSON.parse(t)}catch{return!1}return!0}static isSameDay(t){if(!t)return!1;const r=new Date,e=new Date(t),n=new Date(e.getFullYear(),e.getMonth(),e.getDate());return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()&&n.getDate()===r.getDate()}static getSevenDaysAgo(){return Date.now()-7*24*60*60*1e3}}const S=d;export{S as u};
