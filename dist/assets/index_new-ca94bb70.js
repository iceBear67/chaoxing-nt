import{a as y,r as t,o as C,n as j,b as d,p as S,f as x,F as k,z as V,A as b,e as w,l,q as D}from"./index-26603ea5.js";const u=r=>(V("data-v-2a4a1ed8"),r=r(),b(),r),E=u(()=>w("div",{class:"rtcView",id:"rtcView"},null,-1)),M={key:0,class:"pauseSharing"},I=u(()=>w("i",null,null,-1)),B=u(()=>w("p",null,"对方已暂停共享",-1)),N=[I,B],T={key:1,class:"promoter"},U=y({__name:"index_new",setup(r){const a=t(!1);t(3);const _=t(""),R=t(!1);window.RendererHelper.exitFullScreenWithEsc(!1);let c,v,i;const p=t(!1);C(async()=>{let n=await window.RendererHelper.getInitDataAsync();if(!n){window.close();return}_.value=n.name,c=n.meetCode;let o=await window.RendererHelper.getUID();if(c===""||o===""){window.RendererHelper.alert("连接失败，请切换网络后重试");return}g(),document.addEventListener("contextmenu",e=>{e.preventDefault()}),await m(c)});const g=()=>{window.RendererHelper.on("CMD_MEET_RTC_STU_SCREEN",async n=>{if(!n||!n.data)return;let o=n.data;o.ignoreCmd!=1&&o.type==="unBroadcastScreen"&&s()}),window.RendererHelper.on("showDisconnectView",()=>{p.value=!0}),window.RendererHelper.on("hideDisconnectView",()=>{p.value=!1}),window.RendererHelper.on("screenSharePaused",n=>{a.value=n}),window.ProjectionRtcHelper.onScreenSharePaused((n,o,e)=>{a.value=e}),window.ProjectionRtcHelper.onMessageReceived((n,o)=>{try{let e=JSON.parse(o==null?void 0:o.msgBody);e!=null&&e.endProjection&&s()}catch(e){console.error("parse message body error:",e)}})},m=async n=>{window.ProjectionRtcHelper.onRemoteScreenShareStateChanged((o,e,H)=>{if(!H){e+""==i+""&&s();return}i||(i=e,window.ProjectionRtcHelper.subscribeVideo(o,e,document.querySelector("#rtcView"),!0),window.ProjectionRtcHelper.onNetworkQualityChanged(e,(P,h,f)=>{h>4||f>4?(console.log(`共享人当前网络不佳:${P} tx:${h} rx:${f}`),window.ProjectionRtcHelper.toastMsgLong("共享人当前网络不佳...")):window.ProjectionRtcHelper.hideToastMsg()}))}),window.ProjectionRtcHelper.onUserOffline((o,e)=>{e+""==i+""&&s()}),await window.ProjectionRtcHelper.joinChannel({puid:v,channelCode:n,channelOptions:{autoSubscribeAudio:!0}})},s=()=>{window.ProjectionRtcHelper.releaseSdk(),j(()=>{window.close()})};return(n,o)=>(l(),d(k,null,[E,a.value?(l(),d("div",M,N)):S("",!0),R.value?(l(),d("div",T,x(_.value)+"的屏幕",1)):S("",!0)],64))}});const F=D(U,[["__scopeId","data-v-2a4a1ed8"]]);export{F as default};
