import"./base-82955267.js";/* empty css                     */import{E as rt}from"./el-input-983a785f.js";import{a as te,H as nt,l as d,b as g,j as K,h as n,e as u,p as D,y as G,f as P,J as ue,q as le,t as lt,r as i,c as at,o as ce,F as ee,g as oe,m as j,V as dt,W as mt,u as ct,s as de,I as re,n as ne,_ as ot,L as vt,C as _t,w as gt,v as it,i as ae,N as ft}from"./index-26603ea5.js";import{u as me}from"./index-46519fef.js";import{d as V}from"./avatar-13472c92.js";import{B as ht}from"./index-94663b0f.js";import{M as se}from"./message-4d42f580.js";import{E as st}from"./index-853a0f6e.js";import{T as yt,c as wt}from"./index-b0b4f58c.js";import{M as kt}from"./index-403401b5.js";import{_ as bt}from"./lodash-4dfbea43.js";import{i as xt}from"./type-6514e97f.js";import"./index-9c66cebd.js";import"./index-952b158c.js";import"./icon-803f5cc0.js";import"./typescript-defaf979.js";import"./index-15f48857.js";import"./_baseGet-ad9634b7.js";import"./event-9519ab40.js";import"./use-form-common-props-325f2441.js";import"./index-08289d2b.js";import"./constants-84857360.js";import"./index-12f9ba11.js";import"./aria-60e0cdc6.js";import"./_commonjsHelpers-de833af9.js";import"./message-fe5b63d1.js";import"./validate-f7672251.js";import"./forward-bb18e89e.js";import"./index-e5f0a9f0.js";import"./el-popper-548470bb.js";import"./index-57013d5d.js";import"./createAttachment-a64a5f42.js";import"./index.vue_vue_type_style_index_0_lang-dfb9c5c0.js";const Ct=["src"],Pt=["onClick"],St={class:"content"},It={key:2},Rt=te({__name:"att-base",props:{logo:{type:String,default:""},creater:{type:String,default:""},title:{type:String,default:""},content:{type:String,default:""},from:{type:String,default:""},url:{type:String,default:""},noSurport:{type:Boolean,default:!1}},emits:["nameClick"],setup(E,{emit:q}){const k=E,v=nt.global.t,r=ht("replyAttBase"),f=()=>{q("nameClick")};return(b,t)=>(d(),g("div",{class:K(n(r).b())},[k.logo?(d(),g("div",{key:0,class:K([n(r).e("logo")])},[u("img",{src:k.logo,referrerPolicy:"no-referrer"},null,8,Ct)],2)):D("",!0),k.noSurport?(d(),g("span",It,P(n(v)("message.displayType")),1)):(d(),g("div",{key:1,class:K([n(r).e("info"),n(r).is("hasLogo",!!k.logo)])},[u("div",{class:K(n(r).e("title"))},[u("span",{class:"creater",onClick:G(f,["stop"])},P(k.creater?k.creater+"：":""),9,Pt),ue(P(k.title),1)],2),k.from?(d(),g("div",{key:0,class:K(n(r).e("from"))},[ue(P(n(v)("message.from")),1),u("div",St,P(k.from),1)],2)):(d(),g("div",{key:1,class:K(n(r).e("content"))},P(k.content),3))],2))],2))}});const ut=le(Rt,[["__scopeId","data-v-2d8ea08e"]]),Tt={class:"praise_user"},$t=["src","onClick"],Nt={class:"user_info"},Mt=["onClick"],Lt={class:"time"},Ht={class:"praise_content"},Ut={class:"praise_content_text"},Wt={key:0,class:"praise_content_img"},Bt=["onClick"],Vt=["src"],Dt={key:0,class:"mask"},qt={class:"text"},zt=te({__name:"praise-item",props:{praiseItem:{type:Object,default:()=>{}}},setup(E){const q=E,k=se(),{praiseItem:v}=lt(q),r=i({}),f=i({}),b=at(()=>{var e,x,h;return(e=v.value)!=null&&e.img_data&&((x=v.value)!=null&&x.img_data.length)?(h=v.value)==null?void 0:h.img_data.map(I=>I.imgUrl):[]}),t=e=>{window.RendererHelper.previewImage({},{imgUrl:b.value,curIndex:e,puid:k==null?void 0:k.puid})},_=e=>{var x,h,I,C,y,$,z,N,F,l,a,c,m,T,S,o,s,w,H,U,R,W,B,M,J,Q,X,Y,Z,p,O;switch(e.resourceType){case 30003:r.value={title:((x=e==null?void 0:e.note)==null?void 0:x.title)||"",from:((h=e==null?void 0:e.notebook)==null?void 0:h.name)||"",url:`https://noteyd.chaoxing.com/pc/${(I=e==null?void 0:e.note)==null?void 0:I.cid}`,creater:(C=e==null?void 0:e.note)==null?void 0:C.creatorName},f.value={content:e==null?void 0:e.desc,avator:(e==null?void 0:e.praiserPic)||V,name:e==null?void 0:e.praiserName,time:e==null?void 0:e.createTime};break;case 30001:r.value={title:((y=e==null?void 0:e.topic)==null?void 0:y.title)||(($=e==null?void 0:e.circle)==null?void 0:$.name),from:((z=e==null?void 0:e.topic)==null?void 0:z.title)||((N=e==null?void 0:e.circle)==null?void 0:N.name),url:`https://groupweb.chaoxing.com/pc/topic/jumpToTopicDetail?bbsid=${(F=e==null?void 0:e.circle)==null?void 0:F.bbsid}&uuid=${(l=e.topic)==null?void 0:l.uuid}`,creater:(a=e==null?void 0:e.topic)==null?void 0:a.creatorName},f.value={content:e==null?void 0:e.desc,avator:(e==null?void 0:e.praiserPic)||V,name:e==null?void 0:e.praiserName,time:e==null?void 0:e.createTime};break;case 30002:r.value={title:((c=e==null?void 0:e.topic)==null?void 0:c.title)||((m=e==null?void 0:e.circle)==null?void 0:m.name),from:((T=e==null?void 0:e.topic)==null?void 0:T.title)||((S=e==null?void 0:e.circle)==null?void 0:S.name),url:`https://groupweb.chaoxing.com/pc/topic/jumpToTopicDetail?bbsid=${(o=e==null?void 0:e.circle)==null?void 0:o.bbsid}&uuid=${(s=e.topic)==null?void 0:s.uuid}`,creater:(w=e==null?void 0:e.topic)==null?void 0:w.creatorName},f.value={content:e==null?void 0:e.desc,avator:(e==null?void 0:e.praiserPic)||V,name:e==null?void 0:e.praiserName,time:e==null?void 0:e.createTime};break;case 30004:r.value={title:(H=e==null?void 0:e.noteReply)==null?void 0:H.content,from:((U=e==null?void 0:e.notebook)==null?void 0:U.title)||((R=e==null?void 0:e.notebook)==null?void 0:R.name),url:`https://noteyd.chaoxing.com/pc/${(W=e==null?void 0:e.note)==null?void 0:W.cid}`,creater:(B=e==null?void 0:e.noteReply)==null?void 0:B.name},f.value={content:e==null?void 0:e.desc,avator:(e==null?void 0:e.praiserPic)||V,name:e==null?void 0:e.praiserName,time:e==null?void 0:e.createTime};break;case 30005:r.value={title:((M=e==null?void 0:e.notice)==null?void 0:M.title)||((J=e==null?void 0:e.notice)==null?void 0:J.content),from:"通知",url:`https://notice.chaoxing.com/pc/notice/${(Q=e==null?void 0:e.notice)==null?void 0:Q.idCode}/detail`,creater:(X=e==null?void 0:e.notice)==null?void 0:X.name},f.value={content:e==null?void 0:e.desc,avator:(e==null?void 0:e.praiserPic)||V,name:e==null?void 0:e.praiserName,time:e==null?void 0:e.createTime};break;case 30007:r.value={title:(Y=e==null?void 0:e.special)==null?void 0:Y.name,logo:(Z=e==null?void 0:e.special)==null?void 0:Z.cover,url:(p=e==null?void 0:e.special)==null?void 0:p.openUrl,content:(O=e==null?void 0:e.special)==null?void 0:O.creatorName},f.value={content:e==null?void 0:e.desc,avator:(e==null?void 0:e.praiserPic)||V,name:e==null?void 0:e.praiserName,time:e==null?void 0:e.createTime};break;default:f.value={content:e==null?void 0:e.desc,avator:(e==null?void 0:e.praiserPic)||V,name:e==null?void 0:e.praiserName,time:e==null?void 0:e.createTime},r.value={noSurport:!0};break}},A=async()=>{const e=await window.RendererHelper.getMousePointInWindow(),x=await window.RendererHelper.getMousePointInScreen(),{width:h,height:I}=await window.RendererHelper.getScreenWorkArea(),C=x.x+340>h?e.x-340:e.x,y=x.y+200>I?e.y-200:e.y;window.RendererHelper.openWindow("sview:/#/personalCard",{width:340,height:200,resizable:!1,marginLeft:C,marginTop:y,subWindow:!0,frame:!1,id:"id_PersonInfoWindow"},{myPuid:k.getUserInfo.puid,puid:v.value.praiserPuid})},L=()=>{var e,x;console.log((e=r.value)==null?void 0:e.url),(x=r.value)!=null&&x.url&&window.open(r.value.url)};return ce(()=>{_(v.value)}),(e,x)=>{var h,I,C,y,$,z,N;return d(),g("div",{class:"praise_item",onClick:L},[u("div",Tt,[u("img",{src:(h=f.value)==null?void 0:h.avator,alt:"",onClick:G(A,["stop"])},null,8,$t),u("div",Nt,[u("div",{class:"name",onClick:G(A,["stop"])},P((I=f.value)==null?void 0:I.name),9,Mt),u("div",Lt,P(n(me).timeago((C=f.value)==null?void 0:C.time)),1)])]),u("div",Ht,[u("div",Ut,P((y=f.value)==null?void 0:y.content),1),($=n(v))!=null&&$.img_data&&((z=n(v))!=null&&z.img_data.length)?(d(),g("div",Wt,[(d(!0),g(ee,null,oe((N=n(v))==null?void 0:N.img_data.slice(0,6),(F,l)=>{var a,c;return d(),g("div",{class:"img_item",key:l,onClick:m=>t(l)},[u("img",{src:F.litimg,alt:""},null,8,Vt),((a=n(v))==null?void 0:a.img_data.length)>6&&l==5?(d(),g("div",Dt,[u("div",qt,"+"+P(((c=n(v))==null?void 0:c.img_data.length)-6),1)])):D("",!0)],8,Bt)}),128))])):D("",!0),j(ut,dt(mt(r.value)),null,16)])])}}});const At=le(zt,[["__scopeId","data-v-141953a7"]]),Et={class:"reply"},jt={class:"reply_header"},Ft={class:"reply_content"},Gt=te({__name:"support-list",emits:["close"],setup(E,{emit:q}){const{t:k}=ct(),v=se(),{getUserInfo:r}=de(v),f=i([]),b=i(10),t=i(0),_=i(""),A=i(!1),L=i(!1),e=i();ce(()=>{_.value="",A.value=!1,f.value=[],I()});const x=()=>{q("close")},h=()=>{!L.value&&!A.value&&ne(()=>{const C=e.value;C.wrapRef.scrollHeight-C.wrapRef.scrollTop-C.wrapRef.clientHeight<=100&&I()})},I=()=>{L.value=!0;let C={baseUrl:"https://specie.chaoxing.com",url:"/apis/message/getPraiseListWithPoff",getParams:{puid:r.value.puid,lastValue:_.value,pageSize:b.value},postParams:{},tokenSign:!0};window.MainWindowHelper.genRequest(C).then(y=>{var $;y.result==1&&(console.log(y),y.msg!=k("message.noDataAvailable")&&(f.value.push(...y.data.list),_.value=y.data.lastValue,($=y.data)!=null&&$.allCount&&(t.value=y.data.allCount),A.value=!!y.data.lastPage),L.value=!1)})};return(C,y)=>{const $=ot,z=st;return d(),g("div",Et,[u("div",jt,[u("div",{class:"type",onClick:x},[j($,{"icon-class":"msg_arrow_l",width:"14px",height:"14px",color:"#474C59",style:{"margin-right":"5px"}}),ue(P(n(k)("message.totalLikesReceived"))+"("+P(t.value)+") ",1)])]),u("div",Ft,[j(z,{ref_key:"praiseScrollRef",ref:e,class:"praise_scroll",onScroll:h},{default:re(()=>[(d(!0),g(ee,null,oe(f.value,N=>(d(),g("div",{key:N.id},[j(At,{"praise-item":N},null,8,["praise-item"])]))),128))]),_:1},512)])])}}});const Jt=le(Gt,[["__scopeId","data-v-339eeb55"]]),Kt={key:0,class:"dot"},Qt={class:"reply_user"},Xt=["src","onClick"],Yt={class:"user_info"},Zt=["onClick"],pt={class:"time"},Ot={class:"reply_content"},el={key:0,class:"reply_content_replyed"},tl={class:"reply_content_text"},ll={key:1,class:"reply_content_img"},al=["onClick"],cl=["src"],ol={key:0,class:"mask"},sl={class:"text"},ul=te({__name:"reply-item",props:{replyItem:{type:Object,default:()=>{}},lastGetMsgListTime:{type:Number,default:0}},emits:["deleteItem"],setup(E,{emit:q}){const k=E,v=se(),{getUserInfo:r}=de(v),f=i(!0),b=i({}),{replyItem:t}=lt(k),_=i({}),A=at(()=>{var l,a,c;return(l=t.value)!=null&&l.img_data&&((a=t.value)!=null&&a.img_data.length)?(c=t.value)==null?void 0:c.img_data.map(m=>m.imgUrl):[]}),L=async()=>{var s,w,H,U,R,W;const l=await window.RendererHelper.getMousePointInWindow(),a=await window.RendererHelper.getMousePointInScreen(),{width:c,height:m}=await window.RendererHelper.getScreenWorkArea(),T=a.x+340>c?l.x-340:l.x,S=a.y+200>m?l.y-200:l.y;let o="";if(t.value.replyType==3){let B=((w=(s=t.value)==null?void 0:s.notice)==null?void 0:w.creater_id)||"",M=await window.RendererHelper.getUsersByTuids(String(B));M&&(o=String(M[0].puid))}else if(t.value.replyType==2)o=(U=(H=t.value)==null?void 0:H.note)==null?void 0:U.createrPuid;else if(t.value.replyType==1){let B=((W=(R=t.value)==null?void 0:R.topic)==null?void 0:W.creater_id)||"",M=await window.RendererHelper.getUsersByTuids(String(B));M&&(o=String(M[0].puid))}o&&window.RendererHelper.openWindow("sview:/#/personalCard",{width:340,height:200,resizable:!1,marginLeft:T,marginTop:S,subWindow:!0,frame:!1,id:"id_PersonInfoWindow"},{myPuid:v.getUserInfo.puid,puid:o})},e=async()=>{const l=await window.RendererHelper.getMousePointInWindow();let a="";if(t.value.replyType==3){let c=(t==null?void 0:t.value.creater_id)||"",m=await window.RendererHelper.getUsersByTuids(String(c));m&&(a=String(m[0].puid))}else if(t.value.replyType==2){let c=(t==null?void 0:t.value.creater_id)||"",m=await window.RendererHelper.getUsersByTuids(String(c));m&&(a=String(m[0].puid))}else t.value.replyType==1&&(a=(t==null?void 0:t.value.replyPuid)||"");a&&window.RendererHelper.openWindow("sview:/#/personalCard",{width:340,height:200,resizable:!1,marginLeft:l==null?void 0:l.x,marginTop:l==null?void 0:l.y,subWindow:!0,frame:!1,id:"id_PersonInfoWindow"},{myPuid:v.getUserInfo.puid,puid:a})},x=l=>{const a={imgUrl:A.value,curIndex:l,puid:v==null?void 0:v.puid};console.log("reply-item:imgPreview",a),window.RendererHelper.previewImage({},a)},h=(l,a)=>l.then(c=>[null,c]).catch(c=>a?[Object.assign({},c,a),void 0]:[c,void 0]),I=l=>{var a,c,m,T,S,o,s,w,H,U,R,W,B,M,J,Q,X,Y,Z,p,O,ve,_e,ge,ie,fe,he,ye,we,ke,be,xe,Ce,Pe,Se,Ie,Re,Te,$e,Ne,Me,Le,He,Ue,We,Be,Ve,De,qe,ze,Ae,Ee,je,Fe,Ge,Je,Ke,Qe,Xe,Ye,Ze,pe,Oe,et,tt;switch(l){case 1:b.value={title:((a=t.value)==null?void 0:a.content)||((c=t.value.topic)==null?void 0:c.tTitle)||((m=t.value.topic)==null?void 0:m.content),from:((S=(T=t.value)==null?void 0:T.webComment)==null?void 0:S.title)||((s=(o=t.value)==null?void 0:o.topic)==null?void 0:s.title)||((w=t.value)==null?void 0:w.circle.cName),url:((U=(H=t.value)==null?void 0:H.webComment)==null?void 0:U.url)||`https://groupweb.chaoxing.com/pc/topic/jumpToTopicDetail?bbsid=${(W=(R=t.value)==null?void 0:R.circle)==null?void 0:W.bbsid}&uuid=${(B=t.value.topic)==null?void 0:B.uuid}`,creater:(J=(M=t.value)==null?void 0:M.topic)==null?void 0:J.name},_.value={content:(Q=t.value)==null?void 0:Q.replyCon,avator:((X=t.value)==null?void 0:X.logo)||V,name:(Y=t.value)==null?void 0:Y.replyName,time:(Z=t.value)==null?void 0:Z.create_time};break;case 2:b.value={title:((O=(p=t.value)==null?void 0:p.note)==null?void 0:O.title)||((_e=(ve=t.value)==null?void 0:ve.note)==null?void 0:_e.content),from:"笔记",url:`https://noteyd.chaoxing.com/pc/${(ie=(ge=t.value)==null?void 0:ge.note)==null?void 0:ie.cid}${((fe=t.value)==null?void 0:fe.productName)=="notepart"?`?replyid=${t.value.replyId}`:""}`,creater:((ye=(he=t.value)==null?void 0:he.note)==null?void 0:ye.creater_name)||""},_.value={content:(we=t.value)==null?void 0:we.content,avator:((ke=t.value)==null?void 0:ke.photo)||V,name:(be=t.value)==null?void 0:be.creater_name,time:(xe=t.value)==null?void 0:xe.create_time};break;case 3:b.value={title:((Pe=(Ce=t.value)==null?void 0:Ce.notice)==null?void 0:Pe.title)||((Ie=(Se=t.value)==null?void 0:Se.notice)==null?void 0:Ie.content),from:"通知",url:`https://notice.chaoxing.com/pc/notice/${(Te=(Re=t.value)==null?void 0:Re.notice)==null?void 0:Te.idCode}/detail`,creater:((Ne=($e=t.value)==null?void 0:$e.notice)==null?void 0:Ne.creater_name)||""},_.value={content:(Me=t.value)==null?void 0:Me.content,avator:((Le=t.value)==null?void 0:Le.photo)||V,name:(He=t.value)==null?void 0:He.creater_name,time:(Ue=t.value)==null?void 0:Ue.create_time};break;case 5:b.value={title:(Be=(We=t.value)==null?void 0:We.special)==null?void 0:Be.courseName,content:(De=(Ve=t.value)==null?void 0:Ve.special)==null?void 0:De.author,logo:(ze=(qe=t.value)==null?void 0:qe.special)==null?void 0:ze.cover,url:(Ee=(Ae=t.value)==null?void 0:Ae.special)==null?void 0:Ee.openUrl,creater:((Fe=(je=t.value)==null?void 0:je.notice)==null?void 0:Fe.creater_name)||""},_.value={content:(Ge=t.value)==null?void 0:Ge.content,avator:((Je=t.value)==null?void 0:Je.logo)||V,name:(Ke=t.value)==null?void 0:Ke.creater_name,time:(Qe=t.value)==null?void 0:Qe.create_time};break;default:_.value={content:((Xe=t.value)==null?void 0:Xe.content)||((Ye=t.value)==null?void 0:Ye.replyCon),avator:((Ze=t.value)==null?void 0:Ze.photo)||((pe=t.value)==null?void 0:pe.logo)||V,name:((Oe=t.value)==null?void 0:Oe.creater_name)||((et=t.value)==null?void 0:et.replyName),time:(tt=t.value)==null?void 0:tt.create_time},b.value={noSurport:!0};break}},C=async()=>{let l={baseUrl:"https://groupyd.chaoxing.com",url:"/apis/circle/curDataRecord",getParams:{puid:Number(r.value.puid),bbsid:t.value.circle.bbsid,replyId:t.value.replyId,version:"20171130"},postParams:{},tokenSign:!0};console.log(l);const[a,c]=await h(window.MainWindowHelper.genRequest(l));if(!a)return console.log(c),c},y=async()=>{let l={baseUrl:"https://groupyd.chaoxing.com",url:"/apis/topic/getTopic",getParams:{puid:Number(r.value.puid)},postParams:{maxW:1080,topicId:t.value.replyId},tokenSign:!0};const[a,c]=await h(window.MainWindowHelper.genRequest(l));if(!a)return console.log(c),c},$=async()=>{var S,o;const l=(S=t.value.note)!=null&&S.extension?JSON.parse((o=t.value.note)==null?void 0:o.extension):null,a=(l==null?void 0:l.cooperateVersion)>0;let c={};a?c={baseUrl:"https://noteyd.chaoxing.com",url:"/comm/apis/reply/curReply",getParams:{puid:Number(r.value.puid),sid1:t.value.noteCid,replyId:String(t.value.replyId)},postParams:{},tokenSign:!0}:c={baseUrl:"https://noteyd.chaoxing.com",url:"/apis/note_note/curNoteReply",getParams:{puid:Number(r.value.puid),noteId:t.value.noteId,noteCid:t.value.noteCid,replyId:t.value.replyId,version:"20171130"},postParams:{},tokenSign:!0},console.log(c);const[m,T]=await h(window.MainWindowHelper.genRequest(c));if(!m)return console.log(T),T},z=async()=>{let l={baseUrl:"https://notice.chaoxing.com",url:"/apis/notice/checkReplyExists",getParams:{puid:Number(r.value.puid),replyId:t.value.replyId,idCode:t.value.notice.idCode,from:"replyTo"},postParams:{},tokenSign:!0};console.log(l);const[a,c]=await h(window.MainWindowHelper.genRequest(l));if(!a)return console.log(c),c},N=async()=>{let l={baseUrl:"https://specie.chaoxing.com",url:"/apis/message/delMessageNews",getParams:{puid:Number(r.value.puid),id:Number(t.value.msgId)},postParams:{},tokenSign:!0};console.log(l);const[a,c]=await h(window.MainWindowHelper.genRequest(l));if(console.log(c),!a)return c},F=async()=>{var c;let l=!1,a={};if(t.value.replyType==3?(a=await z(),l=((c=a==null?void 0:a.data)==null?void 0:c.exist)==0):t.value.replyType==2?(a=await $(),l=a.result==-1):t.value.replyType==1?(a=await C(),l=a.result==-1):t.value.replyType==5&&(a=await y(),l=a.result==0),l){const m=await N();(m==null?void 0:m.result)==1&&(yt({content:`${a.errorMsg||"回复已被删除"}`,zIndex:2024,duration:2e3}),q("deleteItem",t.value))}else f.value=!1,window.open(b.value.url)};return ce(()=>{I(t.value.replyType)}),(l,a)=>{var c,m,T,S,o,s,w,H,U;return d(),g("div",{class:"reply_item",onClick:F},[f.value&&E.lastGetMsgListTime&&E.lastGetMsgListTime<n(t).insert_time?(d(),g("div",Kt)):D("",!0),u("div",Qt,[u("img",{src:(c=_.value)==null?void 0:c.avator,alt:"",onClick:G(e,["stop"])},null,8,Xt),u("div",Yt,[u("div",{class:"name",onClick:G(e,["stop"])},P((m=_.value)==null?void 0:m.name),9,Zt),u("div",pt,P(n(me).timeago((T=_.value)==null?void 0:T.time,!0)),1)])]),u("div",Ot,[(S=n(t))!=null&&S.notePartContent?(d(),g("div",el,P((o=n(t))==null?void 0:o.notePartContent),1)):D("",!0),u("div",tl,P((s=_.value)==null?void 0:s.content),1),(w=n(t))!=null&&w.img_data&&((H=n(t))!=null&&H.img_data.length)?(d(),g("div",ll,[(d(!0),g(ee,null,oe((U=n(t))==null?void 0:U.img_data.slice(0,6),(R,W)=>{var B,M;return d(),g("div",{class:"img_item",key:W,onClick:G(J=>x(W),["stop"])},[u("img",{src:R.litimg,alt:""},null,8,cl),((B=n(t))==null?void 0:B.img_data.length)>6&&W==5?(d(),g("div",ol,[u("div",sl,"+"+P(((M=n(t))==null?void 0:M.img_data.length)-6),1)])):D("",!0)],8,al)}),128))])):D("",!0),j(ut,vt(b.value,{onNameClick:L}),null,16)])])}}});const rl=le(ul,[["__scopeId","data-v-402359de"]]),nl=["onContextmenu"],dl={class:"reply_header"},ml={class:"type"},vl={class:"search"},_l={class:"text"},gl={class:"right_arr"},il={key:0,class:"dot"},fl={class:"reply_content"},hl=te({__name:"index",setup(E){const{t:q}=ct(),k=ft(),v=se(),{getUserInfo:r}=de(v),f=i(),b=i(""),t=i(!1),_=i([]),A=i(10),L=i(""),e=i(!1),x=i(!1),h=i(!1),I=i(),C=i(0),y=i(0),$=()=>{t.value=!0,ne(()=>{f.value.focus()})};_t(()=>k.query,o=>{o&&(o!=null&&o.t)&&N()}),ce(()=>{N()});const z=o=>{o.preventDefault(),document.body.click();const s=[];s.push([{name:"刷新",handler:()=>{w(),N()}}]);const{destroy:w}=wt(kt,{menuList:s,left:o==null?void 0:o.x,top:o==null?void 0:o.y});me.windowClickOnce(w)},N=()=>{b.value="",L.value="",e.value=!1,_.value=[],S(),c()},F=()=>{C.value=0,h.value=!0},l=o=>{_.value=_.value.filter(s=>s.msgId!=o.msgId)},a=()=>{!x.value&&!e.value&&ne(()=>{const o=I.value;o.wrapRef.scrollHeight-o.wrapRef.scrollTop-o.wrapRef.clientHeight<=100&&S()})},c=()=>{let o={baseUrl:"https://specie.chaoxing.com",url:"/apis/message/getUnreadPraiseCount",getParams:{puid:r.value.puid},postParams:{},tokenSign:!0};window.MainWindowHelper.genRequest(o).then(s=>{s.result==1&&(C.value=s.data.unreadCount)})},m=bt.debounce(()=>{L.value="",e.value=!1,_.value=[],S()},200),T=()=>{b.value="",L.value="",e.value=!1,_.value=[],S()},S=()=>{x.value=!0;let o={baseUrl:"https://specie.chaoxing.com",url:"/apis/message/getMsgNewsListWithPoff",getParams:{puid:r.value.puid,type:6,lastValue:L.value,pageSize:A.value},postParams:{},tokenSign:!0};b.value&&(o.getParams.kw=encodeURIComponent(b.value)),window.MainWindowHelper.genRequest(o).then(s=>{if(xt(s)){if(_.value.push(...s.data.list),console.log("[getMsgNewsListWithPoff] res:",s),y.value=s.data.lastGetMsgListTime,L.value=s.data.lastValue,e.value=!!s.data.lastPage,_.value.length){const w=_.value[0];v.setReplyMeTime(w==null?void 0:w.create_time)}}else console.error("[getMsgNewsListWithPoff] error",s.errorMsg)}).finally(()=>{x.value=!1})};return(o,s)=>{const w=ot,H=rt,U=st;return d(),g(ee,null,[gt(u("div",{class:"reply",onContextmenu:G(z,["stop"])},[u("div",dl,[u("div",ml,P(n(q)("message.comments")),1),u("div",vl,[t.value?(d(),ae(H,{key:0,ref_key:"searchRef",ref:f,modelValue:b.value,"onUpdate:modelValue":s[0]||(s[0]=R=>b.value=R),modelModifiers:{trim:!0},class:"search_input",placeholder:n(q)("message.search"),onInput:n(m)},{suffix:re(()=>[b.value.length?(d(),ae(w,{key:0,class:"clear","icon-class":"input_clear",width:"14px",height:"14px",onClick:T})):D("",!0),j(w,{"icon-class":"search",width:"18px",height:"18px",color:"rgba(172, 180, 191, 1)"})]),_:1},8,["modelValue","placeholder","onInput"])):D("",!0),t.value?D("",!0):(d(),ae(w,{key:1,"icon-class":"search",width:"20px",height:"20px",color:"#8A8B99",style:{cursor:"pointer"},onClick:$}))])]),u("div",{class:"reply_support",onClick:F},[u("div",_l,P(n(q)("message.newLikes")),1),u("div",gl,[C.value?(d(),g("div",il)):D("",!0),j(w,{"icon-class":"msg_arrow_r",width:"12px",height:"12px",color:"#8A8B99",style:{cursor:"pointer"}})])]),u("div",fl,[j(U,{ref_key:"ScrollbarRef",ref:I,class:"my_scrollbar",onScroll:a},{default:re(()=>[(d(!0),g(ee,null,oe(_.value,R=>(d(),g("div",{key:R.msgId},[j(rl,{"reply-item":R,"last-get-msg-list-time":y.value,onDeleteItem:l},null,8,["reply-item","last-get-msg-list-time"])]))),128))]),_:1},512)])],40,nl),[[it,!h.value]]),h.value?(d(),ae(Jt,{key:0,onClose:s[1]||(s[1]=R=>h.value=!1)})):D("",!0)],64)}}});const pl=le(hl,[["__scopeId","data-v-2cd45273"]]);export{pl as default};
