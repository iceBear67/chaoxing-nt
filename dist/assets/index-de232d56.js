import{a as Y,r as w,c as T,C as F,o as G,n as m,b as c,e as a,j as p,h as l,m as v,I as A,a1 as D,p as g,i as L,M as J,_ as K,z as Q,A as Z,l as d,k as N,y as b,f as E,q as ee}from"./index-26603ea5.js";import{d as U}from"./vuedraggable.umd-b9153632.js";import"./_commonjsHelpers-de833af9.js";const ie=x=>(Q("data-v-03508e95"),x=x(),Z(),x),oe={key:0,class:"tagView_head"},te={class:"tagview tagview_windows"},se=["data-id","onClick"],ae={class:"tagview_item_box"},ne={class:"tagview_item_box_title"},le=["onClick"],de={key:1,class:"right_border"},ce={key:0,class:"tagview_arrow"},re={class:"window_controls"},ve={key:1,class:"tagView_head"},ue=ie(()=>a("div",{class:"mac_controls"},null,-1)),_e={class:"tagview tagview_mac"},we=["data-id","onClick"],pe={class:"tagview_item_box"},ge={class:"tagview_item_box_title"},he=["onClick"],me={key:1,class:"right_border"},fe={key:0,class:"tagview_arrow"},f=200,r=60,xe=Y({__name:"index",setup(x){const O=window.RendererHelper.getPlatform()!=="darwin",k=w("close"),y=w(!1),s=w([]),_=w(),u=w(0),n=w(""),h=T(()=>{let e=u.value/s.value.length;return e=e>f?f:e,e=e<r?r:e,Math.floor(e*s.value.length)>Math.floor(u.value)}),H=e=>e.relatedContext.index!=0,B=e=>{const i=s.value[e.oldIndex];i&&n.value!=i.id&&C(i.id)},R=()=>{const e=s.value.map(i=>i.id);window.MainWindowHelper.updateTabBarList(e)};F(()=>h.value,()=>{m(()=>{u.value=_.value.clientWidth})},{immediate:!0});const I=T(()=>e=>{if(u.value){let i=u.value/s.value.length;return i=i>f?f:i,i=i<r?r:i,{width:i+"px"}}return{width:f+"px"}}),V=T(()=>{if(!n.value)return[];let e=[n.value];const i=s.value.findIndex(t=>t.id==n.value);return i>-1&&i!=0&&e.push(s.value[i-1].id),e});T(()=>n.value?s.value.find(i=>i.id==n.value):null),G(()=>{window.RendererHelper.on("maximize",()=>{y.value=!0}),window.RendererHelper.on("unmaximize",()=>{y.value=!1}),window.RendererHelper.setBlockRefresh(!0),m(()=>{u.value=_.value.clientWidth}),window.RendererHelper.on("updateTabBar",e=>{console.log("updateTabBar",e),s.value=e}),window.RendererHelper.on("tabSelectChanged",e=>{console.log("currentTagId",e),n.value=e;let i=setTimeout(()=>{z(e),clearTimeout(i)},500);console.log("tabSelectChanged:",e)}),window.RendererHelper.on("pageTitleUpdate",e=>{P(e),console.log(`pageTitleUpdate:id:${e.id},title:${e.title}`)}),document.addEventListener("contextmenu",function(e){e.preventDefault(),console.log("contextmenu:",e);let i=e.target;if(i instanceof HTMLElement){let t=i.closest(".tagview_item.tagview_item_active");if(t){let o=t.getAttribute("data-id");o&&window.MainWindowHelper.showTabItemMenu(o,{x:e.screenX,y:e.screenY})}}})});const P=e=>{const i=s.value.findIndex(t=>t.id==e.id);i>=0&&(s.value[i]={...s.value[i],title:e.title})},$=e=>{console.log(e),window.MainWindowHelper.closeWindowSubTab(e)},C=e=>{if(e==n.value)return;n.value=e;let i=setTimeout(()=>{z(e),clearTimeout(i)},500);window.MainWindowHelper.selectWindowSubTab(e)},z=e=>{const i=s.value.findIndex(o=>o.id==e),t=_.value;i<=3?m(()=>{t.scrollTo({left:0,behavior:"smooth"})}):s.value.length-1-i<=4?m(()=>{t.scrollTo({left:t.scrollWidth,behavior:"smooth"})}):(r*i-t.scrollLeft<3*r||t.scrollLeft+t.clientWidth-r*i<3*r)&&m(()=>{t.scrollTo({left:(i-3)*r,behavior:"smooth"})})},S=()=>{window.MainWindowHelper.openTabPanel({list:J(s.value),curId:n.value})},X=()=>{window.RendererHelper.minWindow()},j=()=>{window.RendererHelper.maxOrResotreWindow()},q=()=>{window.RendererHelper.closeWindow()};return window.onresize=()=>{u.value=_.value.clientWidth},(e,i)=>{const t=K;return O?(d(),c("div",oe,[a("div",te,[a("div",{class:p(["tagview_wrapper",l(h)?"dynamics_tagview ":""]),ref_key:"tagview",ref:_},[v(l(U),{modelValue:l(s),"onUpdate:modelValue":i[0]||(i[0]=o=>D(s)?s.value=o:null),animation:"300",filter:".unmover",move:H,onStart:B,onEnd:R},{item:A(({element:o,index:M})=>[(d(),c("div",{"data-id":o.id,class:p(["tagview_item",o.id==n.value?"tagview_item_active":"",M==0?"unmover":""]),style:N(l(I)(o)),key:o.id,onClick:b(W=>C(o.id),["stop"])},[a("div",ae,[a("span",ne,E(o.title||"新窗口"),1),o!=null&&o.canDel?(d(),c("div",{key:0,class:p(["item_close",o.id==n.value?"close_active":""]),onClick:b(W=>$(o.id),["stop"])},[v(t,{"icon-class":"close",width:"12px",height:"12px",color:"#8A8B99"})],10,le)):g("",!0),l(V).includes(o.id)?g("",!0):(d(),c("span",de))])],14,se))]),_:1},8,["modelValue"])],2),l(h)?(d(),c("div",ce,[a("div",{class:"tagview_arrow_svg",onClick:i[1]||(i[1]=o=>S())},[v(t,{"icon-class":"arrow_under",width:"12px",height:"12px"})])])):g("",!0)]),a("div",re,[a("div",{class:"windows_icon_bg",onClick:X},[v(t,{"icon-class":"mini","class-name":"icon-size",width:"12px",height:"12px",color:"#8A8B99"})]),a("div",{class:"windows_icon_bg",onClick:j},[y.value?(d(),L(t,{key:0,"icon-class":"reduction","class-name":"icon-size",width:"12px",height:"12px",color:"#8A8B99"})):(d(),L(t,{key:1,"icon-class":"mix","class-name":"icon-size",width:"12px",height:"12px",color:"#8A8B99"}))]),a("div",{class:"windows_icon_bg close_icon",onClick:q,onMouseover:i[2]||(i[2]=o=>k.value="close_hover"),onMouseleave:i[3]||(i[3]=o=>k.value="close")},[v(t,{"icon-class":k.value,"class-name":"icon-size",width:"12px",height:"12px",color:k.value=="close_hover"?"#fff":"#8A8B99"},null,8,["icon-class","color"])],32)])])):(d(),c("div",ve,[ue,a("div",_e,[a("div",{class:p(["tagview_wrapper",l(h)?"dynamics_tagview ":""]),ref_key:"tagview",ref:_},[v(l(U),{modelValue:l(s),"onUpdate:modelValue":i[4]||(i[4]=o=>D(s)?s.value=o:null),animation:"300",filter:".unmover",move:H,onStart:B,onEnd:R},{item:A(({element:o,index:M})=>[(d(),c("div",{"data-id":o.id,class:p(["tagview_item",o.id==n.value?"tagview_item_active":"",M==0?"unmover":""]),style:N(l(I)(o)),key:o.id,onClick:b(W=>C(o.id),["stop"])},[a("div",pe,[a("span",ge,E(o.title||"新窗口"),1),o!=null&&o.canDel?(d(),c("div",{key:0,class:p(["item_close",o.id==n.value?"close_active":""]),onClick:b(W=>$(o.id),["stop"])},[v(t,{"icon-class":"close",width:"12px",height:"12px",color:"#8A8B99"})],10,he)):g("",!0),l(V).includes(o.id)?g("",!0):(d(),c("span",me))])],14,we))]),_:1},8,["modelValue"])],2),l(h)?(d(),c("div",fe,[a("div",{class:"tagview_arrow_svg",onClick:i[5]||(i[5]=o=>S())},[v(t,{"icon-class":"arrow_under",width:"12px",height:"12px"})])])):g("",!0)])]))}}});const ye=ee(xe,[["__scopeId","data-v-03508e95"]]);export{ye as default};
